$(document).ready(function(){var e;$.getUrlParam=function(e){var a=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),s=window.location.search.substr(1).match(a);return null!=s?unescape(s[2]):null};var a=$.getUrlParam("version"),s=$.getUrlParam("orderId"),l={version:a,order_id:s};console.log(l),$.ajax({type:"POST",url:"http://localhost/learnphp/ajaxOrderJson.php",contentType:"application/json;charset=utf-8",data:JSON.stringify(l),dataType:"JSONP",success:function(a){console.log("mac success"),console.log(a),$.renderOrderDetail(a),e=a},error:function(e){console.log("mac fail"),console.log(e),$(".mac-status").text("mac 添加失败！")}}),$.renderOrderDetail=function(e){$(".one-change-log").remove(),$(".right-board").remove();var a,s,l,i,t,d,r;switch(e[0].product_id<=6&&(a="VINCI 1.0"),"null"==e[0].special_need&&(s="无"),e[0].invoice_category){case"0":l="不需要",i="无",t="无";break;case"1":l="需要",i="个人发票",t="个人";break;case"2":l="需要",i="公司发票",t=e[0].invoice_title}"null"==e[0].express.invoice_id?(d="未寄出",r="无"):(d="已快递",r=e[0].express.invoice_id);var n='\n		<div class="right-board" version="'+e[0].version+'" order="'+e[0].order_id+'">\n			<div class="left-order-detail">\n				<button class="order-status">订单状态：'+e[0].order_status+'</button>\n				<div class="order-detail-table left-order-detail-1">\n					<div class="left-table-list">\n						<p class="table-row">订单号</p>\n						<p class="table-row">状态</p>\n						<p class="table-row">下单日期</p>\n						<p class="table-row">商品名称</p>\n						<p class="table-row">商品颜色</p>\n						<p class="table-row">商品数量</p>\n					</div>\n					<div class="right-table-list">\n						<p class="table-row">'+e[0].order_id+'</p>\n						<p class="table-row">'+e[0].status+'</p>\n						<p class="table-row">'+e[0].dt_create+'</p>\n						<p class="table-row">'+a+'</p>\n						<input id="product_color" class="table-row-input" disabled="disabled" value="'+e[0].product_color+'" />\n						<p class="table-row">'+e[0].product_count+'件</p>\n					</div>\n				</div>\n				<div class="order-detail-table left-order-detail-2">\n					<div class="left-table-list">\n						<p class="table-row">下单电话</p>\n					</div>\n					<div class="right-table-list">\n						<p class="table-row">'+e[0].phonenum+'</p>\n					</div>\n				</div>\n				<div class="order-detail-table left-order-detail-3">\n					<div class="left-table-list">\n						<p class="table-row">特殊加工</p>\n						<p class="table-row">刻字内容</p>\n					</div>\n					<div class="right-table-list">\n						<p class="table-row">'+s+'</p>\n						<p class="table-row">无</p>\n					</div>\n				</div>\n				<div class="order-detail-table left-order-detail-4">\n					<div class="left-table-list">\n						<p class="table-row">交货日期</p>\n						<p class="table-row">收件人姓名</p>\n						<p class="table-row">收件人地址</p>\n						<p class="table-row">收件人电话</p>\n					</div>\n					<div class="right-table-list">\n						<input id="delivery_date" class="table-row-input" disabled="disabled" value="'+e[0].delivery_date+'" />\n						<input id="address_recipient" class="table-row-input" disabled="disabled" value="'+e[0].address.recipient+'" />\n						<input id="address" class="table-row-input" disabled="disabled" value="'+e[0].address.country+e[0].address.province+"省"+e[0].address.city+'市" />\n						<input id="address_phonenum" class="table-row-input" disabled="disabled" value="'+e[0].address.phonenum+'" />\n					</div>\n				</div>\n			</div>\n			<div class="right-order-detail">\n				<div class="order-change">\n					<i class="iconfont order-change-icon">&#xe638;</i>\n					<span class="order-change-explain">修改订单信息</span>\n				</div>\n				<div class="order-detail-table right-order-detail-1">\n					<div class="left-table-list">\n						<p class="table-row">完成状态</p>\n						<p class="table-row">发货地点</p>\n						<p class="table-row">发货批次</p>\n						<p class="table-row">快递单号</p>\n					</div>\n					<div class="right-table-list">\n						<p id="order_status" class="table-row">'+e[0].order_status+'</p>\n						<input id="ship_from" class="table-row-input" value="'+e[0].ship_from+'" disabled="disabled" />\n						<input id="ship_date" class="table-row-input" value="'+e[0].ship_date+'" disabled="disabled" />\n						<input id="express_id" class="table-row-input" value="sf '+e[0].express.express_id+'" disabled="disabled" />\n					</div>\n				</div>\n				<div class="order-detail-table right-order-detail-2">\n					<div class="left-table-list">\n						<p class="table-row">维修状态</p>\n						<p class="table-row">机器问题</p>\n					</div>\n					<div class="right-table-list">\n						<p class="table-row">'+e[0].fix_status+'</p>\n						<p class="table-row">'+e[0].fix_detail+'</p>\n					</div>\n				</div>\n				<div class="order-detail-table right-order-detail-3">\n					<div class="left-table-list">\n						<p class="table-row">需要发票</p>\n						<p class="table-row">公司或个人</p>\n						<p class="table-row">发票信息</p>\n						<p class="table-row">快递状态</p>\n						<p class="table-row">发票信息</p>\n					</div>\n					<div class="right-table-list">\n						<input id="need_invoice" class="table-row-input" value="'+l+'" disabled="disabled" />\n						<input id="invoice_category" class="table-row-input" value="'+i+'" disabled="disabled" />\n						<input id="invoice_title" class="table-row-input" value="'+t+'" disabled="disabled" />\n						<input id="invoice_express" class="table-row-input" value="'+d+'" disabled="disabled" />\n						<input id="invoice_express_id" class="table-row-input" value="yt '+r+'" disabled="disabled" />\n					</div>\n				</div>\n				<div class="order-detail-table right-order-detail-4">\n					<div class="left-table-list">\n						<p class="table-row">支付方式</p>\n						<p class="table-row">支付价格</p>\n						<p class="table-row">支付单号</p>\n					</div>\n					<div class="right-table-list">\n						<p class="table-row">'+e[0].payment_method+'</p>\n						<p class="table-row">RMB '+e[0].act_total_payment+'</p>\n						<p class="table-row">'+e[0].payment_id+"</p>\n					</div>\n				</div>\n			</div>\n		</div>";$(".left-board").after(n);var o="";$.each(e[0].log_list,function(e,a){o=o+'<div class="one-change-log">\n				<span class="remark-spot '+a.department_color+'"></span>\n				<div class="log-detail">\n					<p class="log-by-who">\n						'+a.modified_by+'\n					</p>\n					<p class="log-date">\n						'+a.date+'\n					</p>\n					<p class="log-content">\n						'+a.detail+"\n					</p>\n				</div>\n			</div>"}),$(".log-body").append(o),$.renderProductImage(e[0].product_id),$.changeDetail(e[0].order_status)},$.renderProductImage=function(e){switch(console.log(e),e){case"1":$(".vinci-product-images").removeClass().addClass("white-vinci vinci-product-images");break;case"2":$(".vinci-product-images").removeClass().addClass("yellow-vinci vinci-product-images");break;case"3":$(".vinci-product-images").removeClass().addClass("red-vinci vinci-product-images");break;case"4":$(".vinci-product-images").removeClass().addClass("purple-vinci vinci-product-images");break;case"5":$(".vinci-product-images").removeClass().addClass("green-vinci vinci-product-images");break;case"6":$(".vinci-product-images").removeClass().addClass("black-vinci vinci-product-images")}},$.changeDetail=function(a){$(".order-change-icon").click(function(){"修改订单信息"==$(".order-change-explain").text()?($(this).addClass("start-change-icon"),$(".order-change-explain").text("完成订单修改"),$.decideInputActive(a),$.changeOrderStatus()):($(".submit-modal").fadeIn(200),$(".submit-modal-cancel").click(function(){$(".submit-modal").fadeOut(200)}),$(".submit-modal-confirm").click(function(){switch($(".submit-modal").fadeOut(200),$(".order-status").remove(),$(".left-order-detail").prepend("<button class='order-status'>订单状态："+$("#order_status").text()+"</button>"),$(".table-row-input").removeClass("table-row-input-active").attr("disabled","disabled"),$(".order-change-icon").removeClass("start-change-icon"),$(".order-change-explain").text("修改订单信息"),console.log(1),e[0].product_color=$("#product_color").val(),e[0].product_color){case"黑色":e[0].product_id=6;break;case"白色":e[0].product_id=1;break;case"黄色":e[0].product_id=2;break;case"紫色":e[0].product_id=4;break;case"红色":e[0].product_id=3;break;case"绿色":e[0].product_id=5}e[0].delivery_date=$("#delivery_date").val(),e[0].address={},e[0].address.recipient=$("#address_recipient").val(),e[0].address.detail=$("#address").val(),e[0].address.phonenum=$("#address_phonenum").val(),e[0].order_status=$("#order_status").text(),e[0].ship_from=$("#ship_from").val(),e[0].ship_date=$("#ship_date").val(),e[0].express.express_id=$("#express_id").val(),e[0].invoice_category=$("#invoice_category").attr("category"),e[0].invoice_title=$("#invoice_title").val(),e[0].express.status=$("#invoice_express").val(),e[0].express.invoice_id=$("#invoice_express_id").val(),console.log(e)}))})},$(".submit-modal-cancel").click(function(){$(".submit-modal").fadeOut(200)})});